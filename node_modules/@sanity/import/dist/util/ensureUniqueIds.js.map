{"version":3,"sources":["../../src/util/ensureUniqueIds.ts"],"sourcesContent":["import type {SanityDocument} from '../types.js'\n\ninterface IdAccumulator {\n  seen: string[]\n  duplicates: string[]\n}\n\nfunction reduceDuplicateIds(ids: IdAccumulator, doc: SanityDocument): IdAccumulator {\n  if (!doc._id) {\n    return ids\n  }\n\n  if (ids.seen.includes(doc._id)) {\n    ids.duplicates.push(doc._id)\n  } else {\n    ids.seen.push(doc._id)\n  }\n\n  return ids\n}\n\nexport function ensureUniqueIds(documents: SanityDocument[]): void {\n  const {duplicates} = documents.reduce(reduceDuplicateIds, {\n    seen: [],\n    duplicates: [],\n  })\n\n  const numDupes = duplicates.length\n  if (numDupes === 0) {\n    return\n  }\n\n  throw new Error(\n    `Found ${numDupes} duplicate IDs in the source file:\\n- ${duplicates.join('\\n- ')}`,\n  )\n}\n"],"names":["reduceDuplicateIds","ids","doc","_id","seen","includes","duplicates","push","ensureUniqueIds","documents","reduce","numDupes","length","Error","join"],"mappings":"AAOA,SAASA,mBAAmBC,GAAkB,EAAEC,GAAmB;IACjE,IAAI,CAACA,IAAIC,GAAG,EAAE;QACZ,OAAOF;IACT;IAEA,IAAIA,IAAIG,IAAI,CAACC,QAAQ,CAACH,IAAIC,GAAG,GAAG;QAC9BF,IAAIK,UAAU,CAACC,IAAI,CAACL,IAAIC,GAAG;IAC7B,OAAO;QACLF,IAAIG,IAAI,CAACG,IAAI,CAACL,IAAIC,GAAG;IACvB;IAEA,OAAOF;AACT;AAEA,OAAO,SAASO,gBAAgBC,SAA2B;IACzD,MAAM,EAACH,UAAU,EAAC,GAAGG,UAAUC,MAAM,CAACV,oBAAoB;QACxDI,MAAM,EAAE;QACRE,YAAY,EAAE;IAChB;IAEA,MAAMK,WAAWL,WAAWM,MAAM;IAClC,IAAID,aAAa,GAAG;QAClB;IACF;IAEA,MAAM,IAAIE,MACR,CAAC,MAAM,EAAEF,SAAS,sCAAsC,EAAEL,WAAWQ,IAAI,CAAC,SAAS;AAEvF"}