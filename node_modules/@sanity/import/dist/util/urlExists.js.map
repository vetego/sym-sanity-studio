{"version":3,"sources":["../../src/util/urlExists.ts"],"sourcesContent":["import {request} from 'node:https'\nimport {parse as parseUrl} from 'node:url'\n\nconst MAX_RETRIES = 5\n\nfunction getStatusCodeForUrl(url: string): Promise<number> {\n  const options = {...parseUrl(url), method: 'HEAD' as const}\n  return new Promise((resolve, reject) => {\n    const req = request(options, (res) => {\n      res.resume()\n      resolve(res.statusCode!)\n    })\n    req.on('error', reject)\n    req.end()\n  })\n}\n\nasync function urlExists(url: string): Promise<boolean> {\n  let error: Error = new Error('Max retries exceeded')\n  for (let i = 0; i < MAX_RETRIES; i++) {\n    try {\n      const statusCode = await getStatusCodeForUrl(url)\n      return statusCode === 200\n    } catch (err) {\n      error = err as Error\n\n      // Wait one second before retrying the request\n      await new Promise<void>((resolve) => setTimeout(resolve, 1000))\n    }\n  }\n\n  throw error\n}\n\nexport {urlExists}\n"],"names":["request","parse","parseUrl","MAX_RETRIES","getStatusCodeForUrl","url","options","method","Promise","resolve","reject","req","res","resume","statusCode","on","end","urlExists","error","Error","i","err","setTimeout"],"mappings":"AAAA,SAAQA,OAAO,QAAO,aAAY;AAClC,SAAQC,SAASC,QAAQ,QAAO,WAAU;AAE1C,MAAMC,cAAc;AAEpB,SAASC,oBAAoBC,GAAW;IACtC,MAAMC,UAAU;QAAC,GAAGJ,SAASG,IAAI;QAAEE,QAAQ;IAAe;IAC1D,OAAO,IAAIC,QAAQ,CAACC,SAASC;QAC3B,MAAMC,MAAMX,QAAQM,SAAS,CAACM;YAC5BA,IAAIC,MAAM;YACVJ,QAAQG,IAAIE,UAAU;QACxB;QACAH,IAAII,EAAE,CAAC,SAASL;QAChBC,IAAIK,GAAG;IACT;AACF;AAEA,eAAeC,UAAUZ,GAAW;IAClC,IAAIa,QAAe,IAAIC,MAAM;IAC7B,IAAK,IAAIC,IAAI,GAAGA,IAAIjB,aAAaiB,IAAK;QACpC,IAAI;YACF,MAAMN,aAAa,MAAMV,oBAAoBC;YAC7C,OAAOS,eAAe;QACxB,EAAE,OAAOO,KAAK;YACZH,QAAQG;YAER,8CAA8C;YAC9C,MAAM,IAAIb,QAAc,CAACC,UAAYa,WAAWb,SAAS;QAC3D;IACF;IAEA,MAAMS;AACR;AAEA,SAAQD,SAAS,GAAC"}