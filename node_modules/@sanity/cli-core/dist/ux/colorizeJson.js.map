{"version":3,"sources":["../../src/ux/colorizeJson.ts"],"sourcesContent":["import chalk from 'chalk'\nimport tokenize, {type LexerToken} from 'json-lexer'\n\ninterface KeyToken {\n  raw: string\n  type: 'key'\n  value: string\n}\n\ntype ExtendedLexerToken = KeyToken | LexerToken\n\n/**\n * Colorize JSON output for better readability using simple regex patterns\n */\nconst identity = (inp: string): string => inp\n\nexport function colorizeJson(input: unknown): string {\n  const formatters: Record<ExtendedLexerToken['type'], (str: string) => string> = {\n    key: chalk.white,\n    literal: chalk.bold,\n    number: chalk.yellow,\n    punctuator: chalk.white,\n    string: chalk.green,\n    whitespace: identity,\n  }\n\n  const json = JSON.stringify(input, null, 2)\n\n  return tokenize(json)\n    .map((token, i, arr): ExtendedLexerToken => {\n      // Note how the following only works because we pretty-print the JSON\n      const prevToken = i === 0 ? token : arr[i - 1]\n      if (\n        token.type === 'string' &&\n        prevToken.type === 'whitespace' &&\n        /^\\n\\s+$/.test(prevToken.value)\n      ) {\n        return {...token, type: 'key'}\n      }\n\n      return token\n    })\n    .map((token) => {\n      const formatter = formatters[token.type] || identity\n      return formatter(token.raw)\n    })\n    .join('')\n}\n"],"names":["chalk","tokenize","identity","inp","colorizeJson","input","formatters","key","white","literal","bold","number","yellow","punctuator","string","green","whitespace","json","JSON","stringify","map","token","i","arr","prevToken","type","test","value","formatter","raw","join"],"mappings":"AAAA,OAAOA,WAAW,QAAO;AACzB,OAAOC,cAAiC,aAAY;AAUpD;;CAEC,GACD,MAAMC,WAAW,CAACC,MAAwBA;AAE1C,OAAO,SAASC,aAAaC,KAAc;IACzC,MAAMC,aAA0E;QAC9EC,KAAKP,MAAMQ,KAAK;QAChBC,SAAST,MAAMU,IAAI;QACnBC,QAAQX,MAAMY,MAAM;QACpBC,YAAYb,MAAMQ,KAAK;QACvBM,QAAQd,MAAMe,KAAK;QACnBC,YAAYd;IACd;IAEA,MAAMe,OAAOC,KAAKC,SAAS,CAACd,OAAO,MAAM;IAEzC,OAAOJ,SAASgB,MACbG,GAAG,CAAC,CAACC,OAAOC,GAAGC;QACd,qEAAqE;QACrE,MAAMC,YAAYF,MAAM,IAAID,QAAQE,GAAG,CAACD,IAAI,EAAE;QAC9C,IACED,MAAMI,IAAI,KAAK,YACfD,UAAUC,IAAI,KAAK,gBACnB,UAAUC,IAAI,CAACF,UAAUG,KAAK,GAC9B;YACA,OAAO;gBAAC,GAAGN,KAAK;gBAAEI,MAAM;YAAK;QAC/B;QAEA,OAAOJ;IACT,GACCD,GAAG,CAAC,CAACC;QACJ,MAAMO,YAAYtB,UAAU,CAACe,MAAMI,IAAI,CAAC,IAAIvB;QAC5C,OAAO0B,UAAUP,MAAMQ,GAAG;IAC5B,GACCC,IAAI,CAAC;AACV"}