import { Command } from '@oclif/core';
import { getCliConfig } from './config/cli/getCliConfig.js';
import { findProjectRoot } from './config/findProjectRoot.js';
import { getGlobalCliClient, getProjectCliClient } from './services/apiClient.js';
export class SanityCommand extends Command {
    args;
    flags;
    /**
   * Get the global API client.
   *
   * @param args - The global API client options.
   * @returns The global API client.
   */ getGlobalApiClient = (args)=>getGlobalCliClient(args);
    /**
   * Get the project API client.
   *
   * @param args - The project API client options.
   * @returns The project API client.
   */ getProjectApiClient = (args)=>getProjectCliClient(args);
    /**
   * Helper for outputting to the console.
   *
   * @example
   * ```ts
   * this.output.log('Hello')
   * this.output.warn('Warning')
   * this.output.error('Error')
   * ```
   */ output = {
        error: this.error.bind(this),
        log: this.log.bind(this),
        warn: this.warn.bind(this)
    };
    /**
   * Get the CLI config.
   *
   * @returns The CLI config.
   */ async getCliConfig() {
        const root = await this.getProjectRoot();
        const config = await getCliConfig(root.directory);
        return config;
    }
    /**
   * Get the project ID from the CLI config.
   *
   * @returns The project ID or `undefined` if it's not set.
   */ async getProjectId() {
        const config = await this.getCliConfig();
        return config.api?.projectId;
    }
    /**
   * Get the project's root directory by resolving the config
   *
   * @returns The root project root.
   */ getProjectRoot() {
        return findProjectRoot(process.cwd());
    }
    async init() {
        const { args, flags } = await this.parse({
            args: this.ctor.args,
            baseFlags: super.ctor.baseFlags,
            enableJsonFlag: this.ctor.enableJsonFlag,
            flags: this.ctor.flags,
            strict: this.ctor.strict
        });
        this.args = args;
        this.flags = flags;
        await super.init();
    }
}

//# sourceMappingURL=SanityCommand.js.map