{"version":3,"file":"index.js","sources":["../src/getSchemaTypeIcon.ts","../src/InsertMenu.tsx"],"sourcesContent":["import {type ReferenceSchemaType, type SchemaType} from '@sanity/types'\nimport {type ComponentType} from 'react'\n\n/** @internal */\nexport function getSchemaTypeIcon(schemaType: SchemaType): ComponentType | undefined {\n  // Use reference icon if reference is to one schemaType only\n  const referenceIcon =\n    isReferenceSchemaType(schemaType) && (schemaType.to ?? []).length === 1\n      ? schemaType.to[0]!.icon\n      : undefined\n\n  return schemaType.icon ?? schemaType.type?.icon ?? referenceIcon\n}\n\nfunction isReferenceSchemaType(type: unknown): type is ReferenceSchemaType {\n  return isRecord(type) && (type['name'] === 'reference' || isReferenceSchemaType(type['type']))\n}\n\nfunction isRecord(value: unknown): value is Record<string, unknown> {\n  return !!value && (typeof value == 'object' || typeof value == 'function')\n}\n","import {SearchIcon, ThLargeIcon, UlistIcon} from '@sanity/icons'\nimport {type SchemaType} from '@sanity/types'\nimport {\n  Box,\n  Button,\n  Flex,\n  Grid,\n  Menu,\n  MenuItem,\n  Stack,\n  Tab,\n  TabList,\n  Text,\n  TextInput,\n  Tooltip,\n  type MenuItemProps,\n} from '@sanity/ui/_visual-editing'\nimport {startCase} from 'lodash-es'\nimport {useReducer, useState, type ChangeEvent, type CSSProperties} from 'react'\nimport {isValidElementType} from 'react-is'\n\nimport type {InsertMenuOptions} from './InsertMenuOptions'\n\nimport {getSchemaTypeIcon} from './getSchemaTypeIcon'\n\ntype InsertMenuGroup = NonNullable<InsertMenuOptions['groups']>[number] & {selected: boolean}\ntype InsertMenuViews = NonNullable<InsertMenuOptions['views']>\ntype InsertMenuView = InsertMenuViews[number]\n\ntype InsertMenuEvent =\n  | {type: 'toggle view'; name: InsertMenuView['name']}\n  | {type: 'change query'; query: string}\n  | {type: 'select group'; name: string | undefined}\n\ntype InsertMenuState = {\n  query: string\n  groups: Array<InsertMenuGroup>\n  views: Array<InsertMenuViews[number] & {selected: boolean}>\n}\n\nfunction fullInsertMenuReducer(state: InsertMenuState, event: InsertMenuEvent): InsertMenuState {\n  return {\n    query: event.type === 'change query' ? event.query : state.query,\n    groups:\n      event.type === 'select group'\n        ? state.groups.map((group) => ({...group, selected: event.name === group.name}))\n        : state.groups,\n    views:\n      event.type === 'toggle view'\n        ? state.views.map((view) => ({...view, selected: event.name === view.name}))\n        : state.views,\n  }\n}\n\nconst ALL_ITEMS_GROUP_NAME = 'all-items'\n\nconst gridStyle: CSSProperties = {\n  gridTemplateColumns: 'repeat(auto-fill, minmax(118px, 1fr))',\n  alignItems: 'start',\n}\n\n/** @alpha */\nexport type InsertMenuProps = InsertMenuOptions & {\n  schemaTypes: Array<SchemaType>\n  onSelect: (schemaType: SchemaType) => void\n  labels: {\n    'insert-menu.filter.all-items': string\n    'insert-menu.search.no-results': string\n    'insert-menu.search.placeholder': string\n    'insert-menu.toggle-grid-view.tooltip': string\n    'insert-menu.toggle-list-view.tooltip': string\n  }\n}\n\n/** @alpha */\nexport function InsertMenu(props: InsertMenuProps): React.JSX.Element {\n  const showIcons = props.showIcons === undefined ? true : props.showIcons\n  const showFilter =\n    props.filter === undefined || props.filter === 'auto'\n      ? props.schemaTypes.length > 5\n      : props.filter\n  const [state, send] = useReducer(fullInsertMenuReducer, {\n    query: '',\n    groups: props.groups\n      ? [\n          {\n            name: ALL_ITEMS_GROUP_NAME,\n            title: props.labels['insert-menu.filter.all-items'],\n            selected: true,\n          },\n          ...props.groups.map((group) => ({...group, selected: false})),\n        ]\n      : [],\n    views: (props.views ?? [{name: 'list'}]).map((view, index) => ({\n      ...view,\n      selected: index === 0,\n    })),\n  })\n  const filteredSchemaTypes = filterSchemaTypes(props.schemaTypes, state.query, state.groups)\n  const selectedView = state.views.find((view) => view.selected)\n  const showingFilterOrViews = showFilter || state.views.length > 1\n  const showingTabs = state.groups && state.groups.length > 0\n  const showingAnyOptions = showingFilterOrViews || showingTabs\n\n  return (\n    <Menu padding={0}>\n      <Flex direction=\"column\" height=\"fill\">\n        <Box\n          {...(showingAnyOptions\n            ? {\n                style: {borderBottom: '1px solid var(--card-border-color)'},\n                paddingBottom: 1,\n              }\n            : {})}\n        >\n          {/* filter and views button */}\n          {showingFilterOrViews ? (\n            <Flex flex=\"none\" align=\"center\" paddingTop={1} paddingX={1} gap={1}>\n              {showFilter ? (\n                <Box flex={1}>\n                  <TextInput\n                    autoFocus\n                    border={false}\n                    fontSize={1}\n                    icon={SearchIcon}\n                    onChange={(event: ChangeEvent<HTMLInputElement>) => {\n                      send({type: 'change query', query: event.target.value})\n                    }}\n                    placeholder={props.labels['insert-menu.search.placeholder']}\n                    value={state.query}\n                  />\n                </Box>\n              ) : null}\n              {state.views.length > 1 ? (\n                <Box flex=\"none\">\n                  <ViewToggle\n                    views={state.views}\n                    onToggle={(name) => {\n                      send({type: 'toggle view', name})\n                    }}\n                    labels={props.labels}\n                  />\n                </Box>\n              ) : null}\n            </Flex>\n          ) : null}\n\n          {/* tabs */}\n          {showingTabs ? (\n            <Box paddingTop={1} paddingX={1}>\n              <TabList space={1}>\n                {state.groups.map((group) => (\n                  <Tab\n                    id={`${group.name}-tab`}\n                    aria-controls={`${group.name}-panel`}\n                    key={group.name}\n                    label={group.title ?? startCase(group.name)}\n                    selected={group.selected}\n                    onClick={() => {\n                      send({type: 'select group', name: group.name})\n                    }}\n                  />\n                ))}\n              </TabList>\n            </Box>\n          ) : null}\n        </Box>\n\n        {/* results */}\n        <Box padding={1}>\n          {filteredSchemaTypes.length === 0 ? (\n            <Box padding={2}>\n              <Text muted size={1}>\n                {props.labels['insert-menu.search.no-results']}\n              </Text>\n            </Box>\n          ) : !selectedView ? null : selectedView.name === 'grid' ? (\n            <Grid autoRows=\"auto\" flex={1} gap={1} style={gridStyle}>\n              {filteredSchemaTypes.map((schemaType) => (\n                <GridMenuItem\n                  key={schemaType.name}\n                  icon={showIcons ? getSchemaTypeIcon(schemaType) : undefined}\n                  onClick={() => {\n                    props.onSelect(schemaType)\n                  }}\n                  previewImageUrl={selectedView.previewImageUrl?.(schemaType.name)}\n                  schemaType={schemaType}\n                />\n              ))}\n            </Grid>\n          ) : (\n            <Stack flex={1} space={1}>\n              {filteredSchemaTypes.map((schemaType) => (\n                <MenuItem\n                  key={schemaType.name}\n                  icon={showIcons ? getSchemaTypeIcon(schemaType) : undefined}\n                  onClick={() => {\n                    props.onSelect(schemaType)\n                  }}\n                  text={schemaType.title ?? startCase(schemaType.name)}\n                />\n              ))}\n            </Stack>\n          )}\n        </Box>\n      </Flex>\n    </Menu>\n  )\n}\n\nconst viewToggleIcon: Record<InsertMenuView['name'], React.ElementType> = {\n  grid: ThLargeIcon,\n  list: UlistIcon,\n}\n\nconst viewToggleTooltip: Record<InsertMenuView['name'], keyof ViewToggleProps['labels']> = {\n  grid: 'insert-menu.toggle-grid-view.tooltip',\n  list: 'insert-menu.toggle-list-view.tooltip',\n}\n\ntype ViewToggleProps = {\n  views: InsertMenuState['views']\n  onToggle: (viewName: InsertMenuView['name']) => void\n  labels: Pick<\n    InsertMenuProps['labels'],\n    'insert-menu.toggle-grid-view.tooltip' | 'insert-menu.toggle-list-view.tooltip'\n  >\n}\n\nfunction ViewToggle(props: ViewToggleProps) {\n  const viewIndex = props.views.findIndex((view) => view.selected)\n  const nextView = props.views[viewIndex + 1] ?? props.views[0]!\n\n  return (\n    <Tooltip\n      content={<Text size={1}>{props.labels[viewToggleTooltip[nextView.name]]}</Text>}\n      placement=\"top\"\n      portal\n    >\n      <Button\n        mode=\"bleed\"\n        icon={viewToggleIcon[nextView.name]}\n        onClick={() => {\n          props.onToggle(nextView.name)\n        }}\n      />\n    </Tooltip>\n  )\n}\n\ntype GridMenuItemProps = {\n  onClick: () => void\n  schemaType: SchemaType\n  icon: MenuItemProps['icon']\n  previewImageUrl: ReturnType<\n    NonNullable<\n      Extract<NonNullable<InsertMenuOptions['views']>[number], {name: 'grid'}>['previewImageUrl']\n    >\n  >\n}\n\nfunction GridMenuItem(props: GridMenuItemProps) {\n  const [failedToLoad, setFailedToLoad] = useState(false)\n  const Icon = props.icon\n\n  return (\n    <MenuItem padding={0} radius={2} onClick={props.onClick} style={{overflow: 'hidden'}}>\n      <Flex direction=\"column\" gap={1} padding={1}>\n        <Box\n          flex=\"none\"\n          style={{\n            backgroundColor: 'var(--card-muted-bg-color)',\n            paddingBottom: '66.6%',\n            position: 'relative',\n          }}\n        >\n          {isValidElementType(Icon) ? (\n            <Flex\n              align=\"center\"\n              justify=\"center\"\n              style={{\n                position: 'absolute',\n                top: 0,\n                left: 0,\n                width: '100%',\n                height: '100%',\n              }}\n            >\n              <Text size={1}>\n                <Icon />\n              </Text>\n            </Flex>\n          ) : null}\n          {!props.previewImageUrl || failedToLoad ? null : (\n            <img\n              src={props.previewImageUrl}\n              style={{\n                objectFit: 'contain',\n                width: '100%',\n                height: '100%',\n                position: 'absolute',\n                inset: 0,\n              }}\n              onError={() => {\n                setFailedToLoad(true)\n              }}\n            />\n          )}\n\n          <div\n            style={{\n              position: 'absolute',\n              top: 0,\n              left: 0,\n              width: '100%',\n              height: '100%',\n              boxShadow: 'inset 0 0 0 0.5px var(--card-fg-color)',\n              opacity: 0.1,\n            }}\n          />\n        </Box>\n        <Box flex={1} padding={2}>\n          <Text size={1} weight=\"medium\">\n            {props.schemaType.title ?? props.schemaType.name}\n          </Text>\n        </Box>\n      </Flex>\n    </MenuItem>\n  )\n}\n\nfunction filterSchemaTypes(\n  schemaTypes: Array<SchemaType>,\n  query: string,\n  groups: Array<InsertMenuGroup>,\n) {\n  return schemaTypes.filter(\n    (schemaType) => passesGroupFilter(schemaType, groups) && passesQueryFilter(schemaType, query),\n  )\n}\n\nfunction passesQueryFilter(schemaType: SchemaType, query: string) {\n  const sanitizedQuery = query.trim().toLowerCase()\n\n  return schemaType.title\n    ? schemaType.title?.toLowerCase().includes(sanitizedQuery)\n    : schemaType.name.includes(sanitizedQuery)\n}\n\nfunction passesGroupFilter(schemaType: SchemaType, groups: Array<InsertMenuGroup>) {\n  const selectedGroup = groups.find((group) => group.selected)\n\n  return selectedGroup\n    ? selectedGroup.name === ALL_ITEMS_GROUP_NAME\n      ? true\n      : selectedGroup.of?.includes(schemaType.name)\n    : true\n}\n"],"names":["getSchemaTypeIcon","schemaType","referenceIcon","isReferenceSchemaType","to","length","icon","undefined","type","isRecord","value","fullInsertMenuReducer","state","event","query","groups","map","group","selected","name","views","view","ALL_ITEMS_GROUP_NAME","gridStyle","gridTemplateColumns","alignItems","InsertMenu","props","$","_c","showIcons","showFilter","filter","schemaTypes","t0","labels","title","_temp","t1","t2","_temp2","t3","send","useReducer","T0","T1","T2","t4","t5","t6","t7","t8","t9","filteredSchemaTypes","filterSchemaTypes","selectedView","find","_temp3","showingFilterOrViews","showingTabs","showingAnyOptions","Menu","Flex","t10","style","borderBottom","paddingBottom","t11","SearchIcon","target","t12","group_0","startCase","Box","onSelect","previewImageUrl","schemaType_0","view_0","index","viewToggleIcon","grid","ThLargeIcon","list","UlistIcon","viewToggleTooltip","ViewToggle","viewIndex","findIndex","_temp4","nextView","onToggle","GridMenuItem","failedToLoad","setFailedToLoad","useState","Icon","for","overflow","backgroundColor","position","isValidElementType","top","left","width","height","objectFit","inset","Symbol","boxShadow","opacity","onClick","passesGroupFilter","passesQueryFilter","sanitizedQuery","trim","toLowerCase","includes","selectedGroup","of"],"mappings":"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"}