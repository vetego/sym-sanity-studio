{"version":3,"file":"index.js","sources":["../../src/signed/signedUrlForImage.ts","../../src/signed/signed-builder.ts","../../src/signed/index.ts"],"sourcesContent":["import {signUrl} from '@sanity/signed-urls'\nimport type {ImageUrlBuilderOptions} from '../types'\nimport type {ImageUrlSigningOptions} from './types'\nimport {urlForImage} from '../urlForImage'\n\nexport function signedUrlForImage(\n  options: ImageUrlBuilderOptions,\n  signingOptions: ImageUrlSigningOptions\n): string {\n  // Get the base URL without any signing specific parameters\n  const baseUrl = urlForImage(options)\n  // Sign the URL with the signing parameters\n  return signUrl(baseUrl, signingOptions)\n}\n","import {constructNewOptions, createBuilder, ImageUrlBuilderImpl} from '../builder'\nimport {signedUrlForImage} from './signedUrlForImage'\nimport type {\n  ImageUrlSigningOptions,\n  SignedImageUrlBuilder,\n  SignedImageUrlBuilderOptions,\n  SignedImageUrlBuilderOptionsWithAliases,\n} from './types'\nimport type {SanityClientLike, SanityModernClientLike, SanityProjectDetails} from '../types'\n\nfunction assertValidSignedOptions(\n  opts: Partial<ImageUrlSigningOptions>\n): asserts opts is ImageUrlSigningOptions {\n  if (typeof opts.keyId !== 'string') {\n    throw new Error('Cannot call `signedUrl()` without `keyId`')\n  }\n\n  if (typeof opts.privateKey !== 'string') {\n    throw new Error('Cannot call `signedUrl()` without `privateKey`')\n  }\n}\n\n/**\n * @internal\n */\nexport class SignedImageUrlBuilderImpl\n  extends ImageUrlBuilderImpl\n  implements SignedImageUrlBuilder\n{\n  public declare options: SignedImageUrlBuilderOptions\n\n  constructor(parent: SignedImageUrlBuilderImpl | null, options: SignedImageUrlBuilderOptions) {\n    super(parent, options)\n  }\n\n  override withOptions(options: SignedImageUrlBuilderOptionsWithAliases): this {\n    const newOptions = constructNewOptions(this.options, options)\n    return new SignedImageUrlBuilderImpl(this, {...newOptions}) as this\n  }\n\n  expiry(expiry: string | Date) {\n    return this.withOptions({expiry})\n  }\n\n  signingKey(keyId: string, privateKey: string) {\n    return this.withOptions({keyId, privateKey})\n  }\n\n  signedUrl() {\n    const {expiry, keyId, privateKey, ...rest} = this.options\n    const signedOptions = {expiry, keyId, privateKey}\n    assertValidSignedOptions(signedOptions)\n    return signedUrlForImage(rest, signedOptions)\n  }\n}\n\n/**\n * @public\n */\nexport function createImageUrlBuilder(\n  options?: SanityClientLike | SanityProjectDetails | SanityModernClientLike\n): SignedImageUrlBuilder {\n  return createBuilder(SignedImageUrlBuilderImpl, options)\n}\n","import {defineDeprecated} from '../compat'\nimport {createImageUrlBuilder} from './signed-builder'\n\nexport {createImageUrlBuilder} from './signed-builder'\n\nexport type {\n  AutoMode,\n  CropMode,\n  CropSpec,\n  FitMode,\n  HotspotSpec,\n  ImageFormat,\n  ImageUrlBuilderOptions,\n  ImageUrlBuilderOptionsWithAliases,\n  ImageUrlBuilderOptionsWithAsset,\n  Orientation,\n  SanityAsset,\n  SanityClientConfig,\n  SanityClientLike,\n  SanityImageCrop,\n  SanityImageDimensions,\n  SanityImageFitResult,\n  SanityImageHotspot,\n  SanityImageObject,\n  SanityImageRect,\n  SanityImageSource,\n  SanityImageWithAssetStub,\n  SanityModernClientLike,\n  SanityProjectDetails,\n  SanityReference,\n} from '../types'\n\nexport type {\n  ImageUrlSigningOptions,\n  SignedImageUrlBuilder,\n  SignedImageUrlBuilderOptions,\n  SignedImageUrlBuilderOptionsWithAliases,\n  SignedImageUrlBuilderOptionsWithAsset,\n} from './types'\n\n/**\n * @public\n * @deprecated Use the named export `createImageUrlBuilder` instead of the `default` export\n */\nconst deprecatedcreateImageUrlBuilder = defineDeprecated(createImageUrlBuilder)\nexport default deprecatedcreateImageUrlBuilder\n"],"names":[],"mappings":";;AAKO,SAAS,kBACd,SACA,gBACQ;AAER,QAAM,UAAU,YAAY,OAAO;AAEnC,SAAO,QAAQ,SAAS,cAAc;AACxC;ACHA,SAAS,yBACP,MACwC;AACxC,MAAI,OAAO,KAAK,SAAU;AACxB,UAAM,IAAI,MAAM,2CAA2C;AAG7D,MAAI,OAAO,KAAK,cAAe;AAC7B,UAAM,IAAI,MAAM,gDAAgD;AAEpE;AAKO,MAAM,kCACH,oBAEV;AAAA,EAGE,YAAY,QAA0C,SAAuC;AAC3F,UAAM,QAAQ,OAAO;AAAA,EACvB;AAAA,EAES,YAAY,SAAwD;AAC3E,UAAM,aAAa,oBAAoB,KAAK,SAAS,OAAO;AAC5D,WAAO,IAAI,0BAA0B,MAAM,EAAC,GAAG,YAAW;AAAA,EAC5D;AAAA,EAEA,OAAO,QAAuB;AAC5B,WAAO,KAAK,YAAY,EAAC,QAAO;AAAA,EAClC;AAAA,EAEA,WAAW,OAAe,YAAoB;AAC5C,WAAO,KAAK,YAAY,EAAC,OAAO,YAAW;AAAA,EAC7C;AAAA,EAEA,YAAY;AACV,UAAM,EAAC,QAAQ,OAAO,YAAY,GAAG,KAAA,IAAQ,KAAK,SAC5C,gBAAgB,EAAC,QAAQ,OAAO,WAAA;AACtC,WAAA,yBAAyB,aAAa,GAC/B,kBAAkB,MAAM,aAAa;AAAA,EAC9C;AACF;AAKO,SAAS,sBACd,SACuB;AACvB,SAAO,cAAc,2BAA2B,OAAO;AACzD;ACnBA,MAAM,kCAAkC,iBAAiB,qBAAqB;"}