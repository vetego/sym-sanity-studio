{"version":3,"file":"createAspectAction.js","sources":["../../src/_internal/cli/actions/media/createAspectAction.ts"],"sourcesContent":["import fs from 'node:fs/promises'\nimport path from 'node:path'\n\nimport {type CliCommandAction} from '@sanity/cli'\nimport {createPublishedId} from '@sanity/id-utils'\nimport {camelCase} from 'lodash-es'\n\nimport {withMediaLibraryConfig} from './lib/withMediaLibraryConfig'\n\nconst createAspectAction: CliCommandAction = async (args, context) => {\n  const {output, chalk, prompt, mediaLibrary} = withMediaLibraryConfig(context)\n\n  const title = await prompt.single({\n    message: 'Title',\n    type: 'input',\n  })\n\n  const name = await prompt.single({\n    message: 'Name',\n    type: 'input',\n    default: createPublishedId(camelCase(title)),\n  })\n\n  const safeName = createPublishedId(camelCase(name))\n  const destinationPath = path.resolve(mediaLibrary.aspectsPath, `${safeName}.ts`)\n  const relativeDestinationPath = path.relative(process.cwd(), destinationPath)\n\n  await fs.mkdir(path.resolve(mediaLibrary.aspectsPath), {\n    recursive: true,\n  })\n\n  const destinationPathExists = await fs\n    .stat(destinationPath)\n    .then(() => true)\n    .catch(() => false)\n\n  if (destinationPathExists) {\n    output.error(`A file already exists at ${chalk.bold(relativeDestinationPath)}`)\n    return\n  }\n\n  await fs.writeFile(\n    destinationPath,\n    template({\n      name: safeName,\n      title,\n    }),\n  )\n\n  output.success(`Aspect created! ${chalk.bold(relativeDestinationPath)}`)\n  output.print()\n  output.print('Next steps:')\n  output.print(\n    `Open ${chalk.bold(relativeDestinationPath)} in your code editor and customize the aspect.`,\n  )\n  output.print()\n  output.print('Deploy this aspect by running:')\n  output.print(chalk.bold(`sanity media deploy-aspect ${safeName}`))\n  output.print()\n  output.print('Deploy all aspects by running:')\n  output.print(chalk.bold(`sanity media deploy-aspect --all`))\n}\n\nexport default createAspectAction\n\nfunction template({name, title}: {name: string; title: string}) {\n  return `import {defineAssetAspect, defineField} from 'sanity'\n\nexport default defineAssetAspect({\n  name: '${name}',\n  title: '${title}',\n  type: 'object',\n  fields: [\n    defineField({\n      name: 'string',\n      title: 'Plain String',\n      type: 'string',\n    }),\n  ],\n})\n`\n}\n"],"names":["createAspectAction","args","context","output","chalk","prompt","mediaLibrary","withMediaLibraryConfig","title","single","message","type","name","default","createPublishedId","camelCase","safeName","destinationPath","path","resolve","aspectsPath","relativeDestinationPath","relative","process","cwd","fs","mkdir","recursive","stat","then","catch","error","bold","writeFile","template","success","print"],"mappings":";;;;;AASA,MAAMA,qBAAuC,OAAOC,MAAMC,YAAY;AACpE,QAAM;AAAA,IAACC;AAAAA,IAAQC;AAAAA,IAAOC;AAAAA,IAAQC;AAAAA,EAAAA,IAAgBC,uBAAuBL,OAAO,GAEtEM,QAAQ,MAAMH,OAAOI,OAAO;AAAA,IAChCC,SAAS;AAAA,IACTC,MAAM;AAAA,EAAA,CACP,GAEKC,OAAO,MAAMP,OAAOI,OAAO;AAAA,IAC/BC,SAAS;AAAA,IACTC,MAAM;AAAA,IACNE,SAASC,kBAAkBC,UAAUP,KAAK,CAAC;AAAA,EAAA,CAC5C,GAEKQ,WAAWF,kBAAkBC,UAAUH,IAAI,CAAC,GAC5CK,kBAAkBC,KAAKC,QAAQb,aAAac,aAAa,GAAGJ,QAAQ,KAAK,GACzEK,0BAA0BH,KAAKI,SAASC,QAAQC,IAAAA,GAAOP,eAAe;AAW5E,MATA,MAAMQ,GAAGC,MAAMR,KAAKC,QAAQb,aAAac,WAAW,GAAG;AAAA,IACrDO,WAAW;AAAA,EAAA,CACZ,GAE6B,MAAMF,GACjCG,KAAKX,eAAe,EACpBY,KAAK,MAAM,EAAI,EACfC,MAAM,MAAM,EAAK,GAEO;AACzB3B,WAAO4B,MAAM,4BAA4B3B,MAAM4B,KAAKX,uBAAuB,CAAC,EAAE;AAC9E;AAAA,EACF;AAEA,QAAMI,GAAGQ,UACPhB,iBACAiB,SAAS;AAAA,IACPtB,MAAMI;AAAAA,IACNR;AAAAA,EAAAA,CACD,CACH,GAEAL,OAAOgC,QAAQ,mBAAmB/B,MAAM4B,KAAKX,uBAAuB,CAAC,EAAE,GACvElB,OAAOiC,SACPjC,OAAOiC,MAAM,aAAa,GAC1BjC,OAAOiC,MACL,QAAQhC,MAAM4B,KAAKX,uBAAuB,CAAC,gDAC7C,GACAlB,OAAOiC,SACPjC,OAAOiC,MAAM,gCAAgC,GAC7CjC,OAAOiC,MAAMhC,MAAM4B,KAAK,8BAA8BhB,QAAQ,EAAE,CAAC,GACjEb,OAAOiC,SACPjC,OAAOiC,MAAM,gCAAgC,GAC7CjC,OAAOiC,MAAMhC,MAAM4B,KAAK,kCAAkC,CAAC;AAC7D;AAIA,SAASE,SAAS;AAAA,EAACtB;AAAAA,EAAMJ;AAAoC,GAAG;AAC9D,SAAO;AAAA;AAAA;AAAA,WAGEI,IAAI;AAAA,YACHJ,KAAK;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAWjB;"}